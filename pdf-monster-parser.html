<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Monster Uni-parser for 13th Age</title>
</head>

<body>
  <div class="stack">
    <textarea placeholder="Monster's PDF Description" class="parserInput" id="rawDescription"></textarea>
    <label for="rawAttacks">The attacks' names (including the em-dash) and the traits' names
      (including the colon) MUST be on a single ligne for the parser to
      detected them correctly.</label>
    <textarea name="raw-attacks" placeholder="Monster's PDF Attacks" class="parserInput" id="rawAttacks"></textarea>
    <textarea placeholder="Monster's PDF Traits" class="parserInput" id="rawTraits"></textarea>
    <!-- <textarea placeholder="Monster's PDF Nastier Traits" class="parserInput" id="rawNastierTraits"></textarea> -->
    <textarea placeholder="Monster's PDF Defenses" class="parserInput" id="rawDefenses"></textarea>
  </div>

  <div class="stack">
    <select name="output-format" id="output-select">
      <option value="obsidian" selected>Obsidian Fantasy Statblock</option>
      <option value="latex">LaTeX Monster Card</option>
      <option value="foundry">Foundry Statblock Data</option>
    </select>

    <p>Full transformed output</p>
    <button class="copy" data-for=".base-output#output" id="copy">
      Copy formatted Block
    </button>
    <button id="clear">Clear current Monster</button>

    <textarea class="base-output" id="output"></textarea>

    <button class="foundry-output hidden copy" data-for=".foundry-output#base" id="copy-base">
      Copy Base Actor Data
    </button>
    <textarea class="foundry-output hidden" id="base"></textarea>
    <button class="foundry-output hidden copy" data-for=".foundry-output#items" id="copy-items">
      Copy Actor Item Data
    </button>
    <textarea class="foundry-output hidden" id="items"></textarea>
  </div>
</body>
<link rel="stylesheet" type="text/css" href="style.css" />

<script type="module">
  import {parser, helpers} from "./parser-handler.js";

  document
    .querySelector("#rawDescription")
    .addEventListener("input", parser.parseDescription);
  document
    .querySelector("#rawAttacks")
    .addEventListener("input", parser.parseAttacks);
  document
    .querySelector("#rawTraits")
    .addEventListener("input", parser.parseTraits);
  /* document
     .querySelector("#rawNastierTraits")
     .addEventListener("input", parser.parseNastierTraits); */
  document
    .querySelector("#rawDefenses")
    .addEventListener("input", parser.parseDefenses);

  document
    .querySelector("#output-select")
    .addEventListener("change", helpers.changeOutputFormat);

  document
    .querySelector("#clear")
    .addEventListener("click", helpers.clearCurrentMonster);
  document
    .querySelectorAll("button.copy")
    .forEach((element) =>
      element.addEventListener("click", helpers.copyToClipboard),
    );

  window.parser = parser;
</script>

</html>
